// Code generated by datamapper.
// https://github.com/underbek/datamapper

// Package with_field_pointers_and_errors is a generated datamapper package.
package with_field_pointers_and_errors

import (
	"errors"
	"fmt"

	"github.com/shopspring/decimal"
	"github.com/underbek/datamapper/converts"
)

// ConvertFromToTo convert From by tag map to To by tag map
func ConvertFromToTo(from From) (To, error) {
	fromID, err := converts.ConvertStringToSigned[int](from.ID)
	if err != nil {
		return To{}, fmt.Errorf("convert From.ID -> To.UUID failed: %w", err)
	}

	if from.Age == nil {
		return To{}, errors.New("cannot convert From.Age -> To.Age, field is nil")
	}

	fromAge, err := converts.ConvertStringToDecimal(*from.Age)
	if err != nil {
		return To{}, fmt.Errorf("convert From.Age -> To.Age failed: %w", err)
	}

	var fromChildren *decimal.Decimal
	if from.Children != nil {
		res, err := converts.ConvertStringToDecimal(*from.Children)
		if err != nil {
			return To{}, fmt.Errorf("convert From.Children -> To.Children failed: %w", err)
		}

		fromChildren = &res
	}

	return To{
		UUID:     &fromID,
		Age:      fromAge,
		Children: fromChildren,
	}, nil
}
